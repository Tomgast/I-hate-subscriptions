(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{90005:function(e,t,r){Promise.resolve().then(r.bind(r,94768))},94768:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return L}});var a=r(57437),s=r(2265),i=r(80605),n=r(5526);class l{getCurrentUserId(){try{if(!(localStorage.getItem("next-auth.session-token")||localStorage.getItem("__Secure-next-auth.session-token")))return null;let t=localStorage.getItem("next-auth.session");if(t){var e;let r=JSON.parse(t);return(null==r?void 0:null===(e=r.user)||void 0===e?void 0:e.id)||null}return null}catch(e){return null}}async getSubscriptions(){let e=this.getCurrentUserId();if(!e)return console.warn("No user session found"),[];try{let t=(0,n.createClient)(),{data:r,error:a}=await t.from("subscriptions").select("*").eq("user_id",e).order("created_at",{ascending:!1});if(a)return console.error("Error loading subscriptions:",a),[];return r.map(this.transformFromDatabase)}catch(e){return console.error("Error loading subscriptions:",e),[]}}async addSubscription(e){let t=this.getCurrentUserId();if(!t)throw Error("User must be logged in to add subscriptions");try{let r=(0,n.createClient)(),a=this.transformToDatabase(e,t),{data:s,error:i}=await r.from("subscriptions").insert([a]).select().single();if(i)throw console.error("Error adding subscription:",i),Error("Failed to add subscription");let l=this.transformFromDatabase(s);return this.notifyListeners(),l}catch(e){throw console.error("Error adding subscription:",e),e}}async updateSubscription(e,t){let r=this.getCurrentUserId();if(!r)throw Error("User must be logged in to update subscriptions");try{let a=(0,n.createClient)(),s=this.transformUpdatesToDatabase(t),{data:i,error:l}=await a.from("subscriptions").update({...s,updated_at:new Date().toISOString()}).eq("id",e).eq("user_id",r).select().single();if(l)return console.error("Error updating subscription:",l),null;let o=this.transformFromDatabase(i);return this.notifyListeners(),o}catch(e){return console.error("Error updating subscription:",e),null}}async deleteSubscription(e){let t=this.getCurrentUserId();if(!t)throw Error("User must be logged in to delete subscriptions");try{let r=(0,n.createClient)(),{error:a}=await r.from("subscriptions").delete().eq("id",e).eq("user_id",t);if(a)return console.error("Error deleting subscription:",a),!1;return this.notifyListeners(),!0}catch(e){return console.error("Error deleting subscription:",e),!1}}async getStats(){let e=(await this.getSubscriptions()).filter(e=>e.isActive),t=0,r=0,a={streaming:0,software:0,gaming:0,fitness:0,utilities:0,food:0,education:0,finance:0,productivity:0,entertainment:0,news:0,music:0,cloud_storage:0,communication:0,other:0};e.forEach(e=>{let s=this.getMonthlyAmount(e);t+=s,r+=12*s,a[e.category]+=s});let s=new Date;s.setDate(s.getDate()+7);let i=e.filter(e=>{let t=new Date(e.nextBillingDate);return t<=s&&t>=new Date}).length,n=this.generateMonthlyTrend(e);return{totalMonthly:t,totalYearly:r,activeCount:e.length,dueSoon:i,categoryBreakdown:a,monthlyTrend:n}}getMonthlyAmount(e){let{price:t,billingCycle:r}=e;switch(r){case"monthly":default:return t;case"yearly":return t/12;case"quarterly":return t/3;case"weekly":return 4.33*t;case"daily":return 30*t}}generateMonthlyTrend(e){let t=[],r=new Date;for(let a=11;a>=0;a--){let s=new Date(r.getFullYear(),r.getMonth()-a,1),i=s.toLocaleDateString("en-US",{month:"short",year:"2-digit"}),n=e.filter(e=>new Date(e.createdAt)<=s).reduce((e,t)=>e+this.getMonthlyAmount(t),0);t.push({month:i,amount:n})}return t}async getUpcomingRenewals(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7,t=(await this.getSubscriptions()).filter(e=>e.isActive),r=new Date;return r.setDate(r.getDate()+e),t.filter(e=>{let t=new Date(e.nextBillingDate);return t<=r&&t>=new Date}).sort((e,t)=>new Date(e.nextBillingDate).getTime()-new Date(t.nextBillingDate).getTime())}async searchSubscriptions(e,t){let r=this.getCurrentUserId();if(!r)return[];try{let a=(0,n.createClient)().from("subscriptions").select("*").eq("user_id",r);e.trim()&&(a=a.or("name.ilike.%".concat(e,"%,description.ilike.%").concat(e,"%"))),(null==t?void 0:t.category)&&(a=a.eq("category",t.category)),(null==t?void 0:t.isActive)!==void 0&&(a=a.eq("status",t.isActive?"active":"cancelled"));let{data:s,error:i}=await a.order("created_at",{ascending:!1});if(i)return console.error("Error searching subscriptions:",i),[];let l=s.map(this.transformFromDatabase);return((null==t?void 0:t.minPrice)!==void 0||(null==t?void 0:t.maxPrice)!==void 0)&&(l=l.filter(e=>{let r=this.getMonthlyAmount(e);return(void 0===t.minPrice||!(r<t.minPrice))&&(void 0===t.maxPrice||!(r>t.maxPrice))})),l}catch(e){return console.error("Error searching subscriptions:",e),[]}}async bulkImport(e){let t=this.getCurrentUserId();if(!t)throw Error("User must be logged in to import subscriptions");try{let r=(0,n.createClient)(),a=e.map(e=>this.transformToDatabase(e,t)),{data:s,error:i}=await r.from("subscriptions").insert(a).select();if(i)throw console.error("Error importing subscriptions:",i),Error("Failed to import subscriptions");let l=s.map(this.transformFromDatabase);return this.notifyListeners(),l}catch(e){throw console.error("Error importing subscriptions:",e),e}}async exportData(){return JSON.stringify(await this.getSubscriptions(),null,2)}async clearAllData(){let e=this.getCurrentUserId();if(!e)throw Error("User must be logged in to clear data");try{let t=(0,n.createClient)(),{error:r}=await t.from("subscriptions").delete().eq("user_id",e);if(r)throw console.error("Error clearing data:",r),Error("Failed to clear data");this.notifyListeners()}catch(e){throw console.error("Error clearing data:",e),e}}transformFromDatabase(e){return{id:e.id,name:e.name,description:e.description,price:e.cost,currency:e.currency||"USD",billingCycle:this.mapBillingCycleFromDb(e.billing_cycle),nextBillingDate:e.next_billing_date,isActive:"active"===e.status,category:e.category||"other",website:e.website_url,logo:e.logo_url,notes:e.notes,tags:[],reminderDays:e.reminder_days||3,createdAt:e.created_at,updatedAt:e.updated_at}}transformToDatabase(e,t){return{user_id:t,name:e.name,description:e.description,cost:e.price,currency:e.currency||"USD",billing_cycle:this.mapBillingCycleToDb(e.billingCycle),next_billing_date:e.nextBillingDate,status:e.isActive?"active":"cancelled",category:e.category,website_url:e.website,logo_url:e.logo,notes:e.notes,reminder_days:e.reminderDays||3}}transformUpdatesToDatabase(e){let t={};return void 0!==e.name&&(t.name=e.name),void 0!==e.description&&(t.description=e.description),void 0!==e.price&&(t.cost=e.price),void 0!==e.currency&&(t.currency=e.currency),void 0!==e.billingCycle&&(t.billing_cycle=this.mapBillingCycleToDb(e.billingCycle)),void 0!==e.nextBillingDate&&(t.next_billing_date=e.nextBillingDate),void 0!==e.isActive&&(t.status=e.isActive?"active":"cancelled"),void 0!==e.category&&(t.category=e.category),void 0!==e.website&&(t.website_url=e.website),void 0!==e.logo&&(t.logo_url=e.logo),void 0!==e.notes&&(t.notes=e.notes),void 0!==e.reminderDays&&(t.reminder_days=e.reminderDays),t}mapBillingCycleFromDb(e){switch(e){case"monthly":default:return"monthly";case"yearly":return"yearly";case"weekly":return"weekly";case"daily":return"daily";case"one-time":return"one-time"}}mapBillingCycleToDb(e){switch(e){case"monthly":case"quarterly":default:return"monthly";case"yearly":return"yearly";case"weekly":return"weekly";case"daily":return"daily";case"one-time":return"one-time"}}subscribe(e){return this.listeners.add(e),()=>this.listeners.delete(e)}notifyListeners(){this.listeners.forEach(e=>e())}constructor(){this.listeners=new Set}}let o=new l;var c=r(99376),d=r(22252),u=r(92735),m=r(17689),g=r(88226),h=r(99397),y=r(65302),x=r(95252),p=r(70525),b=r(31047),f=r(73247),v=r(90740),w=r(27648),j=r(71239),k=r(29),N=r.n(k),S=r(47625),C=r(58336),D=r(56940),E=r(97059),F=r(62994),_=r(8147),I=r(54061);function A(e){let{data:t}=e;return(0,a.jsxs)("div",{className:"jsx-145cc90b525d4939 h-64 w-full",children:[(0,a.jsx)(S.h,{width:"100%",height:"100%",children:(0,a.jsxs)(C.w,{data:t,margin:{top:5,right:30,left:20,bottom:5},children:[(0,a.jsx)(D.q,{strokeDasharray:"3 3",className:"stroke-gray-200 dark:stroke-gray-700"}),(0,a.jsx)(E.K,{dataKey:"month",className:"text-gray-600 dark:text-gray-400",fontSize:12}),(0,a.jsx)(F.B,{className:"text-gray-600 dark:text-gray-400",fontSize:12,tickFormatter:e=>"$".concat(e)}),(0,a.jsx)(_.u,{contentStyle:{backgroundColor:"var(--tooltip-bg)",border:"1px solid var(--tooltip-border)",borderRadius:"8px",color:"var(--tooltip-text)"},formatter:e=>["$".concat(e.toFixed(2)),"Monthly Spend"]}),(0,a.jsx)(I.x,{type:"monotone",dataKey:"amount",stroke:"#3b82f6",strokeWidth:2,dot:{fill:"#3b82f6",strokeWidth:2,r:4},activeDot:{r:6,stroke:"#3b82f6",strokeWidth:2}})]})}),(0,a.jsx)(N(),{id:"145cc90b525d4939",children:":root{--tooltip-bg:white;--tooltip-border:#e5e7eb;--tooltip-text:#374151}.dark{--tooltip-bg:#1f2937;--tooltip-border:#4b5563;--tooltip-text:#f3f4f6}"})]})}var T=r(56928),U=r(19533),B=r(53375),M=r(2578),O=r.n(M);function L(){var e,t;let{data:r,status:n}=(0,i.useSession)(),l=(0,c.useRouter)(),{subscriptions:k,stats:N,loading:S,error:C,isAuthenticated:D,getUpcomingRenewals:E,searchSubscriptions:F,exportData:_}=function(){let{data:e,status:t}=(0,i.useSession)(),[r,a]=(0,s.useState)([]),[n,l]=(0,s.useState)(null),[c,d]=(0,s.useState)(!0),[u,m]=(0,s.useState)(null),g=(0,s.useCallback)(async()=>{if("loading"!==t){if(!(null==e?void 0:e.user)){a([]),l(null),d(!1);return}try{d(!0),m(null);let[e,t]=await Promise.all([o.getSubscriptions(),o.getStats()]);a(e),l(t)}catch(e){console.error("Error loading subscriptions:",e),m(e instanceof Error?e.message:"Failed to load subscriptions")}finally{d(!1)}}},[e,t]);(0,s.useEffect)(()=>{g()},[g]),(0,s.useEffect)(()=>o.subscribe(()=>{g()}),[g]);let h=(0,s.useCallback)(async t=>{if(!(null==e?void 0:e.user))throw Error("Must be logged in to add subscriptions");try{return m(null),await o.addSubscription(t)}catch(t){let e=t instanceof Error?t.message:"Failed to add subscription";throw m(e),Error(e)}},[e]),y=(0,s.useCallback)(async(t,r)=>{if(!(null==e?void 0:e.user))throw Error("Must be logged in to update subscriptions");try{return m(null),await o.updateSubscription(t,r)}catch(t){let e=t instanceof Error?t.message:"Failed to update subscription";throw m(e),Error(e)}},[e]),x=(0,s.useCallback)(async t=>{if(!(null==e?void 0:e.user))throw Error("Must be logged in to delete subscriptions");try{return m(null),await o.deleteSubscription(t)}catch(t){let e=t instanceof Error?t.message:"Failed to delete subscription";throw m(e),Error(e)}},[e]),p=(0,s.useCallback)(async(t,r)=>{if(!(null==e?void 0:e.user))return[];try{return m(null),await o.searchSubscriptions(t,r)}catch(e){return m(e instanceof Error?e.message:"Failed to search subscriptions"),[]}},[e]),b=(0,s.useCallback)(async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7;if(!(null==e?void 0:e.user))return[];try{return m(null),await o.getUpcomingRenewals(t)}catch(e){return m(e instanceof Error?e.message:"Failed to get upcoming renewals"),[]}},[e]),f=(0,s.useCallback)(async t=>{if(!(null==e?void 0:e.user))throw Error("Must be logged in to import subscriptions");try{return m(null),await o.bulkImport(t)}catch(t){let e=t instanceof Error?t.message:"Failed to import subscriptions";throw m(e),Error(e)}},[e]),v=(0,s.useCallback)(async()=>{if(!(null==e?void 0:e.user))return"";try{return m(null),await o.exportData()}catch(e){return m(e instanceof Error?e.message:"Failed to export data"),""}},[e]),w=(0,s.useCallback)(async()=>{if(!(null==e?void 0:e.user))throw Error("Must be logged in to clear data");try{m(null),await o.clearAllData()}catch(t){let e=t instanceof Error?t.message:"Failed to clear data";throw m(e),Error(e)}},[e]);return{subscriptions:r,stats:n,loading:c,error:u,isAuthenticated:!!(null==e?void 0:e.user),addSubscription:h,updateSubscription:y,deleteSubscription:x,searchSubscriptions:p,getUpcomingRenewals:b,bulkImport:f,exportData:v,clearAllData:w,refresh:g}}(),[I,M]=(0,s.useState)(""),[L,Z]=(0,s.useState)(!1),[P,R]=(0,s.useState)([]),[W,q]=(0,s.useState)([]),[z,J]=(0,s.useState)(!1),[Y,$]=(0,s.useState)(!1),[G,X]=(0,s.useState)(!1),[Q,H]=(0,s.useState)("");(0,s.useEffect)(()=>{if("loading"!==n&&!D){l.push("/auth/signin");return}},[n,D,l]),(0,s.useEffect)(()=>{let e=new URLSearchParams(window.location.search),t=e.get("bank_connected"),r=e.get("provider");"success"===t&&r&&(H("Successfully connected to ".concat(r.toUpperCase(),"! European bank scanning is now ready.")),window.history.replaceState({},"",window.location.pathname),setTimeout(()=>H(""),5e3))},[]),(0,s.useEffect)(()=>{(async()=>{if(D)try{let[e,t]=await Promise.all([E(30),F(I)]);R(e),q(t)}catch(e){console.error("Error loading dashboard data:",e)}})()},[D,I,k,E,F]);let V=L?P:W;if("loading"===n||S)return(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,a.jsxs)("div",{className:"animate-pulse",children:[(0,a.jsx)("div",{className:"h-8 bg-gray-200 dark:bg-gray-700 rounded w-1/4 mb-8"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[void 0,void 0,void 0,void 0].map((e,t)=>(0,a.jsx)("div",{className:"h-32 bg-gray-200 dark:bg-gray-700 rounded-lg"},t))})]})});if(!D)return null;if(C)return(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,a.jsxs)("div",{className:"card text-center py-12",children:[(0,a.jsx)(d.Z,{className:"h-12 w-12 text-red-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Error Loading Dashboard"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:C}),(0,a.jsx)("button",{onClick:()=>window.location.reload(),className:"btn-primary",children:"Try Again"})]})});let K=async()=>{try{let e=await _(),t=new Blob([e],{type:"application/json"}),r=URL.createObjectURL(t),a=document.createElement("a");a.href=r,a.download="subscriptions-".concat(new Date().toISOString().split("T")[0],".json"),document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(r)}catch(e){console.error("Export error:",e),alert("Failed to export data. Please try again.")}finally{J(!1)}},ee=async()=>{X(!0);try{let e=await fetch("/api/bank-providers/link-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider:"truelayer",countryCode:"GB"})});if(!e.ok)throw Error("Failed to create bank connection");let{authUrl:t}=await e.json();window.location.href=t}catch(e){console.error("Bank scan error:",e),alert("Failed to connect to bank. Please try again.")}finally{X(!1)}};return(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Dashboard"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Track and manage all your subscriptions"})]}),(0,a.jsxs)("div",{className:"flex gap-3 mt-4 sm:mt-0",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{onClick:()=>J(!z),className:"btn-secondary flex items-center gap-2",children:[(0,a.jsx)(u.Z,{className:"h-4 w-4"}),"Export"]}),z&&(0,a.jsx)("div",{className:"absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-md shadow-lg border border-gray-200 dark:border-gray-700 z-10",children:(0,a.jsxs)("div",{className:"py-1",children:[(0,a.jsx)("button",{onClick:()=>{!function(e){let t=e=>{let t=U.Z.find(t=>t.value===e.billingCycle);return e.price*((null==t?void 0:t.multiplier)||1)},r=new Blob([[["Name","Category","Price","Currency","Billing Cycle","Monthly Equivalent","Next Billing Date","Status","Description","Website","Tags","Reminder Days","Created Date"],...e.map(e=>{var r,a;return[e.name,U.H[e.category].label,e.price.toFixed(2),e.currency,(null===(r=U.Z.find(t=>t.value===e.billingCycle))||void 0===r?void 0:r.label)||e.billingCycle,t(e).toFixed(2),new Date(e.nextBillingDate).toLocaleDateString(),e.isActive?"Active":"Inactive",e.description||"",e.website||"",(null===(a=e.tags)||void 0===a?void 0:a.join(", "))||"",e.reminderDays.toString(),new Date(e.createdAt).toLocaleDateString()]})].map(e=>e.map(e=>'"'.concat(e,'"')).join(",")).join("\n")],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a"),s=URL.createObjectURL(r);a.setAttribute("href",s),a.setAttribute("download","subscriptions-".concat(new Date().toISOString().split("T")[0],".csv")),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a)}(k),J(!1)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:"Export as CSV"}),(0,a.jsx)("button",{onClick:()=>{!function(e){let t=new B.default;t.setFontSize(20),t.text("Subscription Report",20,20),t.setFontSize(12),t.text("Generated on: ".concat(new Date().toLocaleDateString()),20,30);let r=e.filter(e=>e.isActive),a=r.reduce((e,t)=>{let r=U.Z.find(e=>e.value===t.billingCycle);return e+t.price*((null==r?void 0:r.multiplier)||1)},0);t.text("Total Active Subscriptions: ".concat(r.length),20,40),t.text("Total Monthly Cost: $".concat(a.toFixed(2)),20,50),t.text("Total Yearly Cost: $".concat((12*a).toFixed(2)),20,60);let s=e=>{let t=U.Z.find(t=>t.value===e.billingCycle);return e.price*((null==t?void 0:t.multiplier)||1)},i=e.map(e=>{var t;return[e.name,U.H[e.category].label,"$".concat(e.price.toFixed(2)),(null===(t=U.Z.find(t=>t.value===e.billingCycle))||void 0===t?void 0:t.label)||e.billingCycle,"$".concat(s(e).toFixed(2)),new Date(e.nextBillingDate).toLocaleDateString(),e.isActive?"Active":"Inactive"]});O()(t,{head:[["Name","Category","Price","Billing","Monthly","Next Billing","Status"]],body:i,startY:80,styles:{fontSize:8,cellPadding:3},headStyles:{fillColor:[59,130,246],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[248,250,252]},columnStyles:{0:{cellWidth:35},1:{cellWidth:25},2:{cellWidth:20},3:{cellWidth:20},4:{cellWidth:20},5:{cellWidth:25},6:{cellWidth:20}}});let n={};r.forEach(e=>{let t=U.H[e.category].label,r=s(e);n[t]=(n[t]||0)+r});let l=t.lastAutoTable.finalY||80;if(Object.keys(n).length>0){t.text("Monthly Spending by Category:",20,l+20);let e=Object.entries(n).sort((e,t)=>{let[,r]=e,[,a]=t;return a-r}).map(e=>{let[t,r]=e;return[t,"$".concat(r.toFixed(2))]});O()(t,{head:[["Category","Monthly Amount"]],body:e,startY:l+30,styles:{fontSize:10,cellPadding:4},headStyles:{fillColor:[59,130,246],textColor:255,fontStyle:"bold"},columnStyles:{0:{cellWidth:80},1:{cellWidth:40}}})}t.save("subscriptions-report-".concat(new Date().toISOString().split("T")[0],".pdf"))}(k),J(!1)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:"Export as PDF"}),(0,a.jsx)("button",{onClick:K,className:"block w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700",children:"Export as JSON"})]})})]}),(0,a.jsxs)("button",{onClick:()=>$(!0),className:"btn-secondary flex items-center gap-2",children:[(0,a.jsx)(m.Z,{className:"h-4 w-4"}),"Bulk Import"]}),(0,a.jsxs)("button",{onClick:ee,disabled:G,className:"btn-secondary flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,a.jsx)(g.Z,{className:"h-4 w-4"}),G?"Connecting...":"Scan Bank"]}),(0,a.jsxs)(w.default,{href:"/subscriptions/new",className:"btn-primary flex items-center gap-2",children:[(0,a.jsx)(h.Z,{className:"h-4 w-4"}),"Add Subscription"]})]})]}),Q&&(0,a.jsx)("div",{className:"mb-6 p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(y.Z,{className:"h-5 w-5 text-green-400 mr-3"}),(0,a.jsx)("p",{className:"text-green-800 dark:text-green-200",children:Q}),(0,a.jsx)("button",{onClick:()=>H(""),className:"ml-auto text-green-600 hover:text-green-800 dark:text-green-400 dark:hover:text-green-200",children:"\xd7"})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,a.jsx)("div",{className:"stat-card",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Monthly Spend"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["$",(null==N?void 0:null===(e=N.totalMonthly)||void 0===e?void 0:e.toFixed(2))||"0.00"]})]}),(0,a.jsx)(x.Z,{className:"h-8 w-8 text-primary-600 dark:text-primary-400"})]})}),(0,a.jsx)("div",{className:"stat-card",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Yearly Spend"}),(0,a.jsxs)("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["$",(null==N?void 0:null===(t=N.totalYearly)||void 0===t?void 0:t.toFixed(2))||"0.00"]})]}),(0,a.jsx)(p.Z,{className:"h-8 w-8 text-primary-600 dark:text-primary-400"})]})}),(0,a.jsx)("div",{className:"stat-card",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Active Subscriptions"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:(null==N?void 0:N.activeCount)||0})]}),(0,a.jsx)(b.Z,{className:"h-8 w-8 text-primary-600 dark:text-primary-400"})]})}),(0,a.jsx)("div",{className:"stat-card",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Due Soon"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:(null==N?void 0:N.dueSoon)||0})]}),(0,a.jsx)(d.Z,{className:"h-8 w-8 text-primary-600 dark:text-primary-400"})]})})]}),(null==N?void 0:N.monthlyTrend)&&N.monthlyTrend.length>0&&(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Monthly Spending Trend"}),(0,a.jsx)(A,{data:N.monthlyTrend})]}),(0,a.jsxs)("div",{className:"card",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Spending by Category"}),(0,a.jsx)("div",{className:"space-y-3",children:(null==N?void 0:N.categoryBreakdown)&&Object.entries(N.categoryBreakdown).filter(e=>{let[t,r]=e;return r>0}).sort((e,t)=>{let[r,a]=e,[s,i]=t;return i-a}).slice(0,5).map(e=>{let[t,r]=e;return(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400 capitalize",children:t.replace("_"," ")}),(0,a.jsxs)("span",{className:"font-medium text-gray-900 dark:text-white",children:["$",r.toFixed(2)]})]},t)})})]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(f.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Search subscriptions...",value:I,onChange:e=>M(e.target.value),className:"input-field pl-10"})]}),(0,a.jsx)("div",{className:"flex gap-2",children:(0,a.jsxs)("button",{onClick:()=>Z(!L),className:"px-4 py-2 rounded-lg font-medium transition-colors ".concat(L?"bg-primary-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300"),children:[(0,a.jsx)(v.Z,{className:"h-4 w-4 inline mr-2"}),L?"All":"Upcoming"]})})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:L?"Upcoming Renewals":"Your Subscriptions"}),(0,a.jsxs)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[V.length," subscription",1!==V.length?"s":""]})]}),0===V.length?(0,a.jsxs)("div",{className:"card text-center py-12",children:[(0,a.jsx)(b.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:L?"No upcoming renewals":"No subscriptions found"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:L?"All your subscriptions are up to date!":I?"Try adjusting your search terms":"Get started by adding your first subscription"}),!L&&!I&&(0,a.jsx)(w.default,{href:"/subscriptions/new",className:"btn-primary",children:"Add Your First Subscription"})]}):(0,a.jsx)("div",{className:"grid gap-4",children:V.map(e=>(0,a.jsx)(j.U,{subscription:e},e.id))})]}),Y&&(0,a.jsx)(T.u,{onClose:()=>$(!1)})]})}},5526:function(e,t,r){"use strict";r.d(t,{createClient:function(){return s}});var a=r(96580);r(40257);let s=()=>(0,a.eI)("https://kumslhaqyummcgytyvxv.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imt1bXNsaGFxeXVtbWNneXR5dnh2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQxNjM1ODQsImV4cCI6MjA2OTczOTU4NH0.g23LOhitLncQkReB0mWh1GaPM1PO714-swLpQNIkpGc")}},function(e){e.O(0,[505,451,605,580,533,673,993,971,117,744],function(){return e(e.s=90005)}),_N_E=e.O()}]);